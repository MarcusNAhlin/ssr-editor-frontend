<div *ngIf="loading" class="spinner-container"></div>
<main>
  <div *ngIf="!loading" class="edit-holder">
    <p class="error" *ngIf="error">{{ error }}</p>

    <div *ngIf="document">
      <div class="doc-header">
        <span>Title: <b>{{ document.title }}</b></span>

        <div class="actions">
          <button type="button" class="icon-btn danger" (click)="deleteDocument()" aria-label="Delete document"
            title="Delete">
            <lucide-icon name="Trash" size="18"></lucide-icon>
          </button>

          <button type="button" class="icon-btn" (click)="showShare = true" [disabled]="!document._id"
            aria-label="Share document" title="Share">
            <lucide-icon name="Share" size="18"></lucide-icon>
          </button>

          <button *ngIf="document.type === 'code'" type="button" class="icon-btn primary" (click)="runCode()"
            [disabled]="loading" aria-label="Run code" title="Run">
            <lucide-icon name="Play" size="18"></lucide-icon>
          </button>
        </div>
      </div>

      <ng-container [ngSwitch]="document.type">
        <app-monaco-editor *ngSwitchCase="'code'" [docId]="document._id || 'demo_doc'" #monacoEditor>
        </app-monaco-editor>

        <app-quill-editor *ngSwitchCase="'richtext'" [docId]="document._id || 'demo_doc'">
        </app-quill-editor>

        <p *ngSwitchDefault class="muted">Unknown doc type: {{ document.type }}</p>
      </ng-container>
    </div>

    <app-share-doc-dialog [open]="showShare" [doc]="document ?? null" (closed)="showShare = false">
    </app-share-doc-dialog>
  </div>
</main>